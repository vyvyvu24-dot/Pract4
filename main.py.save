#!/usr/bin/env python3
import sys
import argparse

def main():
    parser = argparse.ArgumentParser(description='Конвертер конфигураций (Вариант 7)')
    parser.add_argument('-i', '--input', required=True, help='Входной файл')
    parser.add_argument('-o', '--output', required=True, help='Выходной TOML файл')
    
    args = parser.parse_args()
    
    try:
        
        with open(args.input, 'r', encoding='utf-8') as f:
            content = f.read()
        
        # ПРОСТОЙ парсер
        result = []
        for line in content.split('\n'):
            line = line.strip()
            if not line or line.startswith('#') or line.startswith('--'):
                continue
            
            if '=>' in line:
                key_part, value_part = line.split('=>', 1)
                key = key_part.strip().rstrip(':').strip()
                value = value_part.strip()
                
                # Обработка строк @"текст"
                if value.startswith('@"') and value.endswith('"'):
                    value = value[2:-1]
                    result.append(f'{key} = "{value}"')
                
                elif value.isdigit():
                    result.append(f'{key} = {value}')
                else:
                    result.append(f'{key} = "{value}"')
       
        with open(args.output, 'w', encoding='utf-8') as f:
            f.write(f"# Конвертировано из {args.input}\n")
            f.write('\n'.join(result))
        
        print(f"Файл создан: {args.output}")
        print(f"Строк сконвертировано: {len(result)}")
        
    except FileNotFoundError:
        print(f"Ошибка: файл {args.input} не найден")
        sys.exit(1)
    except Exception as e:
        print(f"Ошибка: {e}")
        sys.exit(1)

if __name__ == '__main__':
    main()
import argparse
from parser import parse_text
import tomlkit


def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("--input", required=True)
    parser.add_argument("--output", required=True)
    args = parser.parse_args()

    with open(args.input, "r", encoding="utf-8") as f:
        text = f.read()

    data = parse_text(text)

    toml_doc = tomlkit.document()
    for k, v in data.items():
        toml_doc[k] = v

    with open(args.output, "w", encoding="utf-8") as f:
        f.write(tomlkit.dumps(toml_doc))


if __name__ == "__main__":
    main()
